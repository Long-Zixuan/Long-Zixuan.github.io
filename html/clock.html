<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Clock</title>
    <link rel="shortcut icon" href="../src/img/zi.ico">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            position: relative; /* æ·»åŠ ç›¸å¯¹å®šä½ */
            overflow: hidden; /* éšè—æº¢å‡ºçš„å†…å®¹ */
        }
        #container {
            text-align: center;
            height: auto;
            width: 36vw;
            padding: 20px;
            top:50%;
            left:50%;
            transform: translate(-50%,-50%);
            position: absolute;
            background-color: rgba(255, 255, 255, 0.2); /* åŠé€æ˜èƒŒæ™¯ */
            backdrop-filter: blur(10px); /* èƒŒæ™¯æ¨¡ç³Š */
            -webkit-backdrop-filter: blur(10px); /* å…¼å®¹è€ç‰ˆæœ¬ Safari */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            z-index: 1;
        }
        #DanmuContainer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .danmu {
            position: absolute;
            white-space: nowrap;
            font-size: 16px;
            color: white;

            height: 20vh;
            width: 150vw;
            
            padding: 5px 10px;
            
            z-index: 0;
        }
        a {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #66ccff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        a:hover {
            background-color: #ed65ff;
        }
        h1 {
            font-size: 4.5dvw;
            color: #000000; /* ä¿®æ”¹ä¸ºæ‰€éœ€çš„å›ºå®šé¢œè‰² */
        }
        h2 {
            font-size: 2dvw;
            color: #000000; /* ä¿®æ”¹ä¸ºæ‰€éœ€çš„å›ºå®šé¢œè‰² */
        }
    </style>
</head>
<body>
    <div id="container">
        <h1><span id = "hour">00</span>:<span id = "min">00</span>:<span id = "sec">00</span></h1>
        <h2><span id = "year">2004</span>-<span id = "month">04</span>-<span id = "day">04</span>  <span id = "week"></span></h2>
        <p><span id = "error">You broswer is too old!</span></p>
        
        <a href="../index.html"></a>
    </div>

    <div id = "DanmuContainer"></div>

    <script>
        //import {isMobile} from 'react-device-detect';
       const body = document.body;
       const danmuCon = document.getElementById('DanmuContainer');

        let canCreatDanmu = true;

        document.addEventListener("visibilitychange", function() {
        var string = document.visibilityState
        console.log(string)
        if (string === 'hidden') {  // å½“é¡µé¢ç”±å‰ç«¯è¿è¡Œåœ¨åç«¯æ—¶ï¼Œå‡ºå‘æ­¤ä»£ç 
            console.log('ç½‘é¡µå¤„äºåå°è¿è¡Œ');
            canCreatDanmu = false;
            
        }
        if (string === 'visible') {   // å½“é¡µé¢ç”±éšè—è‡³æ˜¾ç¤ºæ—¶
            console.log('ç½‘é¡µå¤„äºå‰å°è¿è¡Œ');
            canCreatDanmu = true;
        }
      });

        //let danmuTop = 0;

        function createDanmu() {
            if(!canCreatDanmu) return;
            //const danmu = document.createElement('div');
            for (let danmuTop = 0; danmuTop < 100; danmuTop += 20) 
            {
            
                const danmu = document.createElement('img');
                danmu.className = 'danmu';

                danmu.src = '../src/img/pay/LS2.svg';
                
                // danmu.style.top = `${Math.random() * 100}vh`; // éšæœºå‚ç›´ä½ç½®
                danmu.style.top = `${danmuTop}vh`; 
                //danmuTop += 20;
                //danmuTop = danmuTop % 100;
                let flag = (danmuTop / 20) % 2;
                let left = -200;
                let speed = 1;
                if (navigator.userAgent.indexOf('Firefox') >= 0)
                {
                    speed = 1.5;
                    console.log("Firefox");
                }
                if(flag == 0)
                {
                    danmu.style.left = `${100}vw`; //
                    left = 100;
                    speed = -speed;
                }
                else
                {
                    danmu.style.left = `${-200}vw`; //
                }
                danmuCon.appendChild(danmu);

                // ç§»åŠ¨å¼¹å¹•
                
                const interval = setInterval(() => {
                    left += speed; // è°ƒæ•´é€Ÿåº¦
                    danmu.style.left = `${left}vw`;
                    /*if (left > 200) { // å½“å¼¹å¹•ç§»å‡ºå±å¹•æ—¶ç§»é™¤
                        clearInterval(interval);
                        body.removeChild(danmu);
                    }*/
                }, 20);
                setTimeout(() => {
                    clearInterval(interval);
                    danmuCon.removeChild(danmu);
                }, 10000);
            }
        }

        //let creatDanmuTime = (windowWidth / windowHeight) * 1000 ;

        // å®šæ—¶ç”Ÿæˆå¼¹å¹•
       // if(system.win)//åªåœ¨winç”Ÿæˆå¼¹å¹•
       // {
            let creatDanmuFunc = setInterval(createDanmu, 3300);
       // }

        const container = document.getElementById('container');
        const yearEle = document.getElementById('year');
        const monthEle = document.getElementById('month');
        const dayEle = document.getElementById('day');
        const weekEle = document.getElementById('week');
        const hourEle = document.getElementById('hour');
        const minEle = document.getElementById('min');
        const secEle = document.getElementById('sec');
        const errorEle = document.getElementById('error');
        
        
        const h1 = document.querySelector('h1');
        const h2 = document.querySelector('h2');
       
        let i = 1;
        let colMax = 255;
        let colMin = 200;
        let colCount = colMax;
        const weeks = new Array ("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday");
        errorEle.textContent = "";
        

        function loop() {
            container.style.backgroundColor = `rgba(${colCount}, ${colCount}, 255, 0.8)`;
            body.style.backgroundColor = `rgb(${colMax - colCount + colMin}, ${colMax - colCount + colMin}, 255)`;
            h1.style.color = `rgb(${colMax - colCount + colMin}, ${colMax - colCount + colMin}, 255)`;
            h2.style.color = `rgb(${colMax - colCount + colMin}, ${colMax - colCount + colMin}, 255)`;

             let now = new Date();
            let year = now.getFullYear();
            let month = ('0' + (now.getMonth() + 1)).slice(-2);
            let day = ('0' + now.getDate()).slice(-2);
            let hours = ('0' + now.getHours()).slice(-2);
            let minutes = ('0' + now.getMinutes()).slice(-2);
            let seconds = ('0' + now.getSeconds()).slice(-2);
            let week = weeks[now.getDay()];
            if(month == '04' && day == '04')
            {
                week = week + "   ğŸ‚";
            }

            yearEle.textContent = year;
            monthEle.textContent = month;
            dayEle.textContent = day;
          //  weekEle.textContent = getWeek(now.getDay());
            hourEle.textContent = hours;
            minEle.textContent = minutes;
            secEle.textContent = seconds;
            weekEle.textContent = week;

            if (colCount == colMax || colCount == colMin) {
                i = -i;
            }
            colCount += i;
        }

        let windowWidth = window.innerWidth;
        let windowHeight = window.innerHeight;

        window.addEventListener('resize', () => {
            windowWidth = window.innerWidth;
            windowHeight = window.innerHeight;
            windowLogic(windowHeight, windowWidth);
        });
        function windowLogic(windowHeight, windowWidth) {
            if (windowWidth > windowHeight) {
                h1.style.fontSize = "4.5dvw";
                h2.style.fontSize = "2dvw";
                container.style.width = "36vw";
                container.style.height = "auto";
                
            } else {
                h1.style.fontSize = "5dvh";
                h2.style.fontSize = "2.5dvh";
                container.style.width = "60vw";
                container.style.height = "auto";
               
            }
        }
        windowLogic(windowHeight, windowWidth);
        setInterval(loop, 80);
    </script>
</body>
</html>